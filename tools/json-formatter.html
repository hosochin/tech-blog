---
layout: default
title: JSON整形・圧縮
---

<h1>JSON整形・圧縮ツール</h1>

<div class="tool-container">
    <div class="input-section">
        <label for="input-json">JSONデータを入力:</label>
        <textarea id="input-json" placeholder='{"key": "value", "array": [1, 2, 3]}' rows="8"></textarea>
    </div>

    <div class="button-section">
        <button onclick="formatJson()" class="action-btn format-btn">整形</button>
        <button onclick="compressJson()" class="action-btn compress-btn">圧縮</button>
        <button onclick="validateJson()" class="action-btn validate-btn">検証</button>
        <button onclick="clearJson()" class="action-btn clear-btn">クリア</button>
    </div>

    <div class="output-section">
        <div class="output-header">
            <label for="output-json">結果:</label>
            <div id="json-info" class="json-info"></div>
        </div>
        <textarea id="output-json" readonly rows="8"></textarea>
        <button onclick="copyToClipboard()" class="copy-btn">コピー</button>
    </div>

    <div class="info-section">
        <h3>JSONツールの機能</h3>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>整形</h4>
                <p>JSONデータを読みやすい形式にインデントして整形します。</p>
            </div>
            
            <div class="feature-card">
                <h4>圧縮</h4>
                <p>不要な空白・改行を削除してファイルサイズを最小化します。</p>
            </div>
            
            <div class="feature-card">
                <h4>検証</h4>
                <p>JSONの構文エラーをチェックし、有効性を確認します。</p>
            </div>
            
            <div class="feature-card">
                <h4>情報表示</h4>
                <p>文字数・バイト数・オブジェクト数などの統計情報を表示します。</p>
            </div>
        </div>

        <h4>主な用途:</h4>
        <ul>
            <li>API レスポンスの構造確認</li>
            <li>設定ファイルの整形・検証</li>
            <li>JSONデータの圧縮・最適化</li>
            <li>デバッグ時のデータ可視化</li>
        </ul>
    </div>
</div>

<style>
.tool-container {
    max-width: 900px;
    margin: 0 auto;
}

.input-section, .output-section {
    margin-bottom: 20px;
}

.input-section label, .output-section label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: #333;
}

.output-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.json-info {
    font-size: 0.85em;
    color: #666;
    display: flex;
    gap: 15px;
}

textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 13px;
    resize: vertical;
    transition: border-color 0.2s ease;
}

textarea:focus {
    outline: none;
    border-color: #0066cc;
}

#output-json {
    background: #f8f9fa;
}

.button-section {
    text-align: center;
    margin: 20px 0;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 8px;
}

.action-btn {
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.format-btn {
    background: #0066cc;
    color: white;
}

.format-btn:hover {
    background: #0052a3;
}

.compress-btn {
    background: #28a745;
    color: white;
}

.compress-btn:hover {
    background: #218838;
}

.validate-btn {
    background: #ffc107;
    color: #212529;
}

.validate-btn:hover {
    background: #e0a800;
}

.clear-btn {
    background: #6c757d;
    color: white;
}

.clear-btn:hover {
    background: #545b62;
}

.copy-btn {
    margin-top: 10px;
    padding: 8px 16px;
    background: #17a2b8;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
}

.copy-btn:hover {
    background: #138496;
}

.info-section {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 8px;
    margin-top: 30px;
}

.info-section h3 {
    margin: 0 0 20px 0;
    color: #0066cc;
}

.info-section h4 {
    margin: 20px 0 10px 0;
    color: #333;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.feature-card {
    background: white;
    padding: 15px;
    border-radius: 6px;
    border-left: 4px solid #0066cc;
}

.feature-card h4 {
    margin: 0 0 8px 0;
    color: #0066cc;
    font-size: 1em;
}

.feature-card p {
    margin: 0;
    font-size: 0.9em;
    color: #555;
    line-height: 1.5;
}

.info-section ul {
    padding-left: 20px;
    color: #555;
}

@media (max-width: 768px) {
    .button-section {
        flex-direction: column;
        align-items: center;
    }
    
    .action-btn {
        width: 200px;
    }
    
    .json-info {
        flex-direction: column;
        gap: 5px;
    }
}
</style>

<script>
function formatJson() {
    const input = document.getElementById('input-json').value.trim();
    if (!input) {
        document.getElementById('output-json').value = '';
        updateJsonInfo('');
        return;
    }
    
    try {
        const parsed = JSON.parse(input);
        const formatted = JSON.stringify(parsed, null, 2);
        document.getElementById('output-json').value = formatted;
        updateJsonInfo(formatted, 'formatted');
    } catch (error) {
        document.getElementById('output-json').value = `エラー: ${error.message}`;
        updateJsonInfo('');
    }
}

function compressJson() {
    const input = document.getElementById('input-json').value.trim();
    if (!input) {
        document.getElementById('output-json').value = '';
        updateJsonInfo('');
        return;
    }
    
    try {
        const parsed = JSON.parse(input);
        const compressed = JSON.stringify(parsed);
        document.getElementById('output-json').value = compressed;
        updateJsonInfo(compressed, 'compressed');
    } catch (error) {
        document.getElementById('output-json').value = `エラー: ${error.message}`;
        updateJsonInfo('');
    }
}

function validateJson() {
    const input = document.getElementById('input-json').value.trim();
    if (!input) {
        document.getElementById('output-json').value = 'JSONデータを入力してください';
        updateJsonInfo('');
        return;
    }
    
    try {
        const parsed = JSON.parse(input);
        const info = analyzeJson(parsed);
        document.getElementById('output-json').value = `✅ 有効なJSONです\n\n構造情報:\n${info}`;
        updateJsonInfo(input, 'valid');
    } catch (error) {
        document.getElementById('output-json').value = `❌ 無効なJSONです\n\nエラー: ${error.message}`;
        updateJsonInfo('');
    }
}

function analyzeJson(obj) {
    const info = [];
    
    function analyze(data, depth = 0) {
        if (Array.isArray(data)) {
            info.push(`- 配列 (${data.length}個の要素)`);
            data.forEach(item => analyze(item, depth + 1));
        } else if (typeof data === 'object' && data !== null) {
            const keys = Object.keys(data);
            info.push(`- オブジェクト (${keys.length}個のプロパティ)`);
            keys.forEach(key => {
                const value = data[key];
                const type = Array.isArray(value) ? 'array' : typeof value;
                if (depth < 2) { // 深すぎる構造は省略
                    info.push(`  - ${key}: ${type}`);
                }
            });
        }
    }
    
    analyze(obj);
    return info.slice(0, 10).join('\n'); // 最初の10行まで
}

function updateJsonInfo(text, type = '') {
    const infoElement = document.getElementById('json-info');
    if (!text) {
        infoElement.innerHTML = '';
        return;
    }
    
    const charCount = text.length;
    const byteCount = new Blob([text]).size;
    const lineCount = text.split('\n').length;
    
    let typeInfo = '';
    if (type === 'formatted') typeInfo = '整形済み';
    else if (type === 'compressed') typeInfo = '圧縮済み';
    else if (type === 'valid') typeInfo = '有効';
    
    infoElement.innerHTML = `
        <span>${charCount}文字</span>
        <span>${byteCount}バイト</span>
        <span>${lineCount}行</span>
        ${typeInfo ? `<span>${typeInfo}</span>` : ''}
    `;
}

function clearJson() {
    document.getElementById('input-json').value = '';
    document.getElementById('output-json').value = '';
    updateJsonInfo('');
}

function copyToClipboard() {
    const output = document.getElementById('output-json');
    output.select();
    output.setSelectionRange(0, 99999);
    
    try {
        document.execCommand('copy');
        const btn = document.querySelector('.copy-btn');
        const originalText = btn.textContent;
        btn.textContent = 'コピーしました!';
        btn.style.background = '#28a745';
        
        setTimeout(() => {
            btn.textContent = originalText;
            btn.style.background = '#17a2b8';
        }, 2000);
    } catch (err) {
        alert('コピーに失敗しました');
    }
}

// サンプルJSONの挿入（デモ用）
window.addEventListener('DOMContentLoaded', function() {
    const sampleJson = {
        "name": "サンプル API",
        "version": "1.0.0",
        "users": [
            {"id": 1, "name": "田中太郎", "active": true},
            {"id": 2, "name": "佐藤花子", "active": false}
        ],
        "config": {
            "timeout": 3000,
            "debug": true
        }
    };
    
    // 初回表示時にサンプルを設定
    setTimeout(() => {
        document.getElementById('input-json').value = JSON.stringify(sampleJson, null, 2);
    }, 100);
});
</script>